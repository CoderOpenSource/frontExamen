import{a as G}from"./chunk-4IA42FLE.js";import{a as W,b as $,e as j,h as B,i as L,k as z,m as P}from"./chunk-OGDTTBTQ.js";import{b as F}from"./chunk-6QFG5ZSD.js";import{Ba as l,Ca as S,Oa as x,Pb as I,Qa as g,Qb as T,Rb as V,Ta as i,Tb as k,Ua as n,Ya as C,Za as _,_a as h,aa as y,cb as N,db as s,eb as b,fb as E,ib as w,ja as m,jb as M,ka as p,kb as D,mb as v,pb as O,sa as A}from"./chunk-TYC4EHML.js";function q(r,d){if(r&1&&(i(0,"option",24),s(1),n()),r&2){let a=d.$implicit;g("ngValue",a.id),l(),b(a.nombre)}}function K(r,d){if(r&1){let a=C();i(0,"div")(1,"input",26),_("change",function(){let o=m(a).$implicit,t=h(2);return p(t.toggleProgramacionSelection(o))}),n(),s(2),n()}if(r&2){let a=d.$implicit,e=h(2);l(),g("checked",e.isProgramacionSelected(a)),l(),E(" ",e.getProgramacionDescripcion(a)," ")}}function Q(r,d){if(r&1&&(i(0,"div"),x(1,K,3,2,"div",25),n()),r&2){let a=h();l(),g("ngForOf",a.programaciones)}}function X(r,d){r&1&&(i(0,"p"),s(1,"A\xFAn no hay programaciones"),n())}function Y(r,d){if(r&1&&(i(0,"div",27),s(1),n()),r&2){let a=h();g("ngClass",a.toastClass),l(),E(" ",a.toastMessage,`
`)}}var H=(()=>{let d=class d{constructor(e){this.http=e,this.docente={id:0,nombre:"",apellido:"",email:"",contrasena:"",departamentoId:null,programacionAcademicaIds:[]},this.isEditMode=!1,this.closeModal=new A,this.saveDocente=new A,this.departamentos=[],this.materias=[],this.aulas=[],this.sesionesClase=[],this.programaciones=[],this.toastMessage=null,this.toastClass=""}ngOnInit(){this.loadDepartamentos(),this.loadMaterias(),this.loadAulas(),this.loadSesionesClase(),this.loadProgramaciones()}loadDepartamentos(){this.http.get("http://192.168.0.15/departamentos/").subscribe(e=>{this.departamentos=e},e=>{console.error("Error loading departamentos",e)})}loadMaterias(){this.http.get("http://192.168.0.15/materias/").subscribe(e=>{this.materias=e},e=>{console.error("Error loading materias",e)})}loadAulas(){this.http.get("http://192.168.0.15/aulas/").subscribe(e=>{this.aulas=e},e=>{console.error("Error loading aulas",e)})}loadSesionesClase(){this.http.get("http://192.168.0.15/sesionesclase/").subscribe(e=>{this.sesionesClase=e},e=>{console.error("Error loading sesiones clase",e)})}loadProgramaciones(){this.http.get("http://192.168.0.15/programacionesacademicas/").subscribe(e=>{this.programaciones=e},e=>{console.error("Error loading programaciones",e)})}getProgramacionDescripcion(e){let o=this.materias.find(f=>f.id===e.materiaId),t=this.aulas.find(f=>f.id===e.aulaId),u=this.getFormattedSesionClase(e.sesionClaseIds);return`${e.grupo}: ${o?.nombre||"Desconocido"} - ${t?.nombre||"Desconocido"} (${u})`}getFormattedSesionClase(e){return this.sesionesClase.filter(t=>e.includes(t.id)).map(t=>`${t.diaSemana.slice(0,3).toUpperCase()} ${t.horaInicio}-${t.horaFin}`).join(", ")}showToast(e,o){this.toastMessage=e,this.toastClass=o==="success"?"bg-green-500 text-white":"bg-red-500 text-white",setTimeout(()=>{this.toastMessage=null},2e3)}onClose(){this.closeModal.emit()}onSave(){this.saveDocente.emit(this.docente)}isProgramacionSelected(e){return this.docente.programacionAcademicaIds.includes(e.id)}toggleProgramacionSelection(e){this.isProgramacionSelected(e)?this.docente.programacionAcademicaIds=this.docente.programacionAcademicaIds.filter(o=>o!==e.id):this.docente.programacionAcademicaIds.push(e.id)}};d.\u0275fac=function(o){return new(o||d)(S(F))},d.\u0275cmp=y({type:d,selectors:[["app-docente-modal"]],inputs:{docente:"docente",isEditMode:"isEditMode"},outputs:{closeModal:"closeModal",saveDocente:"saveDocente"},standalone:!0,features:[v],decls:40,vars:11,consts:[["noProgramaciones",""],[1,"fixed","inset-0","bg-gray-600","bg-opacity-50","overflow-y-auto","h-full","w-full",3,"click"],[1,"relative","top-20","mx-auto","p-5","border","w-96","shadow-lg","rounded-md","bg-white",3,"click"],[1,"mt-3","text-center","text-blue-700","font-bold"],[1,"mt-4"],[1,"mb-4"],["for","nombre",1,"block","text-gray-700","text-sm","font-bold","mb-2"],["placeholder","Ingrese el nombre",1,"shadow","appearance-none","border","rounded","w-full","py-2","px-3","text-gray-700","leading-tight","focus:outline-none","focus:shadow-outline",3,"ngModelChange","ngModel"],["for","apellido",1,"block","text-gray-700","text-sm","font-bold","mb-2"],["placeholder","Ingrese el apellido",1,"shadow","appearance-none","border","rounded","w-full","py-2","px-3","text-gray-700","leading-tight","focus:outline-none","focus:shadow-outline",3,"ngModelChange","ngModel"],["for","email",1,"block","text-gray-700","text-sm","font-bold","mb-2"],["placeholder","Ingrese el email",1,"shadow","appearance-none","border","rounded","w-full","py-2","px-3","text-gray-700","leading-tight","focus:outline-none","focus:shadow-outline",3,"ngModelChange","ngModel"],["for","contrasena",1,"block","text-gray-700","text-sm","font-bold","mb-2"],["placeholder","Ingrese la contrase\xF1a","type","password",1,"shadow","appearance-none","border","rounded","w-full","py-2","px-3","text-gray-700","leading-tight","focus:outline-none","focus:shadow-outline",3,"ngModelChange","ngModel"],["for","departamento",1,"block","text-gray-700","text-sm","font-bold","mb-2"],[1,"shadow","appearance-none","border","rounded","w-full","py-2","px-3","text-gray-700","leading-tight","focus:outline-none","focus:shadow-outline",3,"ngModelChange","ngModel"],["disabled","",3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],["for","programaciones",1,"block","text-gray-700","text-sm","font-bold","mb-2"],[4,"ngIf","ngIfElse"],[1,"flex","items-center","justify-between","px-4","py-3","space-x-4"],[1,"px-4","py-2","bg-blue-500","text-white","text-base","font-medium","rounded-md","shadow-sm","w-1/2",3,"click"],[1,"px-4","py-2","bg-gray-500","text-white","text-base","font-medium","rounded-md","shadow-sm","w-1/2",3,"click"],["class","fixed bottom-4 left-4 px-4 py-2 rounded shadow-lg",3,"ngClass",4,"ngIf"],[3,"ngValue"],[4,"ngFor","ngForOf"],["type","checkbox",3,"change","checked"],[1,"fixed","bottom-4","left-4","px-4","py-2","rounded","shadow-lg",3,"ngClass"]],template:function(o,t){if(o&1){let u=C();i(0,"div",1),_("click",function(){return m(u),p(t.onClose())}),i(1,"div",2),_("click",function(c){return m(u),p(c.stopPropagation())}),i(2,"h3",3),s(3),n(),i(4,"div",4)(5,"div",5)(6,"label",6),s(7,"Nombre"),n(),i(8,"input",7),D("ngModelChange",function(c){return m(u),M(t.docente.nombre,c)||(t.docente.nombre=c),p(c)}),n()(),i(9,"div",5)(10,"label",8),s(11,"Apellido"),n(),i(12,"input",9),D("ngModelChange",function(c){return m(u),M(t.docente.apellido,c)||(t.docente.apellido=c),p(c)}),n()(),i(13,"div",5)(14,"label",10),s(15,"Email"),n(),i(16,"input",11),D("ngModelChange",function(c){return m(u),M(t.docente.email,c)||(t.docente.email=c),p(c)}),n()(),i(17,"div",5)(18,"label",12),s(19,"Contrase\xF1a"),n(),i(20,"input",13),D("ngModelChange",function(c){return m(u),M(t.docente.contrasena,c)||(t.docente.contrasena=c),p(c)}),n()(),i(21,"div",5)(22,"label",14),s(23,"Departamento"),n(),i(24,"select",15),D("ngModelChange",function(c){return m(u),M(t.docente.departamentoId,c)||(t.docente.departamentoId=c),p(c)}),i(25,"option",16),s(26,"Seleccione un departamento"),n(),x(27,q,2,2,"option",17),n()(),i(28,"div",5)(29,"label",18),s(30,"Programaciones"),n(),x(31,Q,2,1,"div",19)(32,X,2,0,"ng-template",null,0,O),n()(),i(34,"div",20)(35,"button",21),_("click",function(){return m(u),p(t.onSave())}),s(36,"Guardar"),n(),i(37,"button",22),_("click",function(){return m(u),p(t.onClose())}),s(38,"Cerrar"),n()()()(),x(39,Y,2,2,"div",23)}if(o&2){let u=N(33);l(3),b(t.isEditMode?"Editar Docente":"A\xF1adir Docente"),l(5),w("ngModel",t.docente.nombre),l(4),w("ngModel",t.docente.apellido),l(4),w("ngModel",t.docente.email),l(4),w("ngModel",t.docente.contrasena),l(4),w("ngModel",t.docente.departamentoId),l(),g("ngValue",null),l(2),g("ngForOf",t.departamentos),l(4),g("ngIf",t.programaciones.length>0)("ngIfElse",u),l(8),g("ngIf",t.toastMessage)}},dependencies:[k,I,T,V,P,L,z,W,B,$,j]});let r=d;return r})();function Z(r,d){if(r&1&&(i(0,"li"),s(1),n()),r&2){let a=d.$implicit,e=h(2);l(),b(e.getProgramacionDescripcion(a))}}function ee(r,d){if(r&1){let a=C();i(0,"tr")(1,"td",3),s(2),n(),i(3,"td",3),s(4),n(),i(5,"td",3),s(6),n(),i(7,"td",3),s(8),n(),i(9,"td",3),s(10),n(),i(11,"td",3)(12,"ul"),x(13,Z,2,1,"li",4),n()(),i(14,"td",3)(15,"button",10),_("click",function(){let o=m(a).$implicit,t=h();return p(t.editDocente(o.id))}),s(16,"Editar"),n(),i(17,"button",11),_("click",function(){let o=m(a).$implicit,t=h();return p(t.confirmDelete(o.id))}),s(18,"Eliminar"),n()()()}if(r&2){let a=d.$implicit,e=h();l(2),b(a.id),l(2),b(a.nombre),l(2),b(a.apellido),l(2),b(a.email),l(2),b(e.getDepartamentoNombre(a.departamentoId)),l(3),g("ngForOf",a.programacionAcademicaIds)}}function te(r,d){if(r&1&&(i(0,"div",12),s(1),n()),r&2){let a=h();g("ngClass",a.toastClass),l(),E(" ",a.toastMessage," ")}}function oe(r,d){if(r&1){let a=C();i(0,"app-docente-modal",13),_("closeModal",function(){m(a);let o=h();return p(o.handleCloseModal())})("saveDocente",function(o){m(a);let t=h();return p(t.saveDocente(o))}),n()}if(r&2){let a=h();g("docente",a.selectedDocente)("isEditMode",a.isEditMode)}}function ne(r,d){if(r&1){let a=C();i(0,"app-confirm-modal",14),_("confirm",function(){m(a);let o=h();return p(o.deleteDocente())})("cancel",function(){m(a);let o=h();return p(o.handleCloseConfirmModal())}),n()}if(r&2){let a=h();g("message",a.confirmMessage)}}var fe=(()=>{let d=class d{constructor(e){this.http=e,this.docentes=[],this.departamentos=[],this.materias=[],this.aulas=[],this.sesionesClase=[],this.programaciones=[],this.selectedDocente={id:0,nombre:"",apellido:"",email:"",contrasena:"",departamentoId:null,programacionAcademicaIds:[]},this.showModal=!1,this.showConfirmModal=!1,this.isEditMode=!1,this.docenteIdToDelete=null,this.toastMessage=null,this.toastClass="",this.confirmMessage="\xBFEst\xE1s seguro?"}ngOnInit(){this.loadDocentes(),this.loadDepartamentos(),this.loadMaterias(),this.loadAulas(),this.loadSesionesClase(),this.loadProgramaciones()}loadDocentes(){this.http.get("http://192.168.0.15/docentes/").subscribe(e=>{this.docentes=e,console.log(e)},e=>{console.error("Error loading docentes",e)})}loadDepartamentos(){this.http.get("http://192.168.0.15/departamentos/").subscribe(e=>{this.departamentos=e},e=>{console.error("Error loading departamentos",e)})}loadMaterias(){this.http.get("http://192.168.0.15/materias/").subscribe(e=>{this.materias=e},e=>{console.error("Error loading materias",e)})}loadAulas(){this.http.get("http://192.168.0.15/aulas/").subscribe(e=>{this.aulas=e},e=>{console.error("Error loading aulas",e)})}loadSesionesClase(){this.http.get("http://192.168.0.15/sesionesclase/").subscribe(e=>{this.sesionesClase=e},e=>{console.error("Error loading sesiones clase",e)})}loadProgramaciones(){this.http.get("http://192.168.0.15/programacionesacademicas/").subscribe(e=>{this.programaciones=e},e=>{console.error("Error loading programaciones",e)})}getDepartamentoNombre(e){let o=this.departamentos.find(t=>t.id===e);return o?o.nombre:"Desconocido"}getMateriaNombre(e){let o=this.materias.find(t=>t.id===e);return o?o.nombre:"Desconocido"}getAulaNombre(e){let o=this.aulas.find(t=>t.id===e);return o?o.nombre:"Desconocido"}getFormattedSesionClase(e){return this.sesionesClase.filter(t=>e.includes(t.id)).map(t=>`${t.diaSemana.slice(0,3).toUpperCase()} ${t.horaInicio}-${t.horaFin}`).join(" ")}getProgramacionDescripcion(e){let o=this.programaciones.find(t=>t.id===e);if(o){let t=this.getMateriaNombre(o.materiaId),u=this.getAulaNombre(o.aulaId),f=this.getFormattedSesionClase(o.sesionClaseIds);return`${o.grupo}: ${t} - ${u} (${f})`}return"Desconocido"}editDocente(e){this.selectedDocente=this.docentes.find(o=>o.id===e)||this.selectedDocente,this.isEditMode=!0,this.showModal=!0}addDocente(){this.selectedDocente={id:0,nombre:"",apellido:"",email:"",contrasena:"",departamentoId:null,programacionAcademicaIds:[]},this.isEditMode=!1,this.showModal=!0}confirmDelete(e){this.docenteIdToDelete=e,this.confirmMessage="\xBFEst\xE1s seguro de eliminar este docente?",this.showConfirmModal=!0}deleteDocente(){this.docenteIdToDelete!==null&&this.http.delete(`http://192.168.0.15/docentes/${this.docenteIdToDelete}`).subscribe(()=>{this.showToast("Docente eliminado con \xE9xito","success"),this.loadDocentes(),this.docenteIdToDelete=null,this.showConfirmModal=!1},e=>{this.showToast("Error al eliminar el docente","error"),console.error("Error deleting docente",e)})}cancelDelete(){this.docenteIdToDelete=null,this.showConfirmModal=!1}saveDocente(e){console.log("Docente antes de enviar:",JSON.stringify(e,null,2));let o={id:this.isEditMode?e.id:null,nombre:e.nombre,apellido:e.apellido,email:e.email,contrasena:e.contrasena,rolId:2,departamentoId:e.departamentoId,programacionAcademicaIds:e.programacionAcademicaIds};this.isEditMode?this.http.put(`http://192.168.0.15/docentes/${e.id}`,o).subscribe(t=>{this.showToast("Docente actualizado con \xE9xito","success"),this.loadDocentes()},t=>{this.showToast("Error al actualizar el docente","error"),console.error("Error updating docente",t)}):this.http.post("http://192.168.0.15/docentes/",o).subscribe(t=>{this.showToast("Docente creado con \xE9xito","success"),this.loadDocentes()},t=>{this.showToast("Error al crear el docente","error"),console.error("Error creating docente",t)}),this.handleCloseModal()}handleCloseModal(){this.showModal=!1}handleCloseConfirmModal(){this.showConfirmModal=!1}showToast(e,o){this.toastMessage=e,this.toastClass=o==="success"?"bg-green-500 text-white":"bg-red-500 text-white",setTimeout(()=>{this.toastMessage=null},2e3)}};d.\u0275fac=function(o){return new(o||d)(S(F))},d.\u0275cmp=y({type:d,selectors:[["app-docente"]],standalone:!0,features:[v],decls:28,vars:4,consts:[[1,"container","mx-auto","px-4","py-8","relative"],[1,"text-2xl","font-bold","mb-4","text-center"],[1,"min-w-full","bg-white","text-center"],[1,"py-2","px-4","border-b"],[4,"ngFor","ngForOf"],[1,"flex","justify-start","mt-4"],[1,"bg-green-500","text-white","px-4","py-2","rounded-md",3,"click"],["class","mt-4",3,"ngClass",4,"ngIf"],[3,"docente","isEditMode","closeModal","saveDocente",4,"ngIf"],[3,"message","confirm","cancel",4,"ngIf"],[1,"bg-blue-500","text-white","px-3","py-1","rounded-md",3,"click"],[1,"bg-red-500","text-white","px-3","py-1","rounded-md","ml-2",3,"click"],[1,"mt-4",3,"ngClass"],[3,"closeModal","saveDocente","docente","isEditMode"],[3,"confirm","cancel","message"]],template:function(o,t){o&1&&(i(0,"div",0)(1,"h1",1),s(2,"Gestionar Docentes"),n(),i(3,"table",2)(4,"thead")(5,"tr")(6,"th",3),s(7,"ID"),n(),i(8,"th",3),s(9,"Nombre"),n(),i(10,"th",3),s(11,"Apellido"),n(),i(12,"th",3),s(13,"Email"),n(),i(14,"th",3),s(15,"Departamento"),n(),i(16,"th",3),s(17,"Programaciones"),n(),i(18,"th",3),s(19,"Acciones"),n()()(),i(20,"tbody"),x(21,ee,19,6,"tr",4),n()(),i(22,"div",5)(23,"button",6),_("click",function(){return t.addDocente()}),s(24,"A\xF1adir Docente"),n()(),x(25,te,2,2,"div",7),n(),x(26,oe,1,2,"app-docente-modal",8)(27,ne,1,1,"app-confirm-modal",9)),o&2&&(l(21),g("ngForOf",t.docentes),l(4),g("ngIf",t.toastMessage),l(),g("ngIf",t.showModal),l(),g("ngIf",t.showConfirmModal))},dependencies:[k,I,T,V,P,H,G],styles:["table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:10px;text-align:left;border:1px solid #dee2e6}th[_ngcontent-%COMP%]{background-color:#011d3a;color:#fff}"]});let r=d;return r})();export{fe as DocenteComponent};
