import{a as $}from"./chunk-MSGFT5JS.js";import{a as T,b as D,e as P,h as O,i as W,k as A,m as N}from"./chunk-OGDTTBTQ.js";import{b as k}from"./chunk-6QFG5ZSD.js";import{Ba as l,Ca as v,Oa as _,Qa as p,Qb as I,Rb as F,Ta as r,Tb as V,Ua as o,Ya as w,Za as u,_a as c,a as C,aa as H,d as B,db as d,eb as x,fb as M,gb as y,ib as f,ja as m,jb as b,ka as h,kb as E,mb as S}from"./chunk-TYC4EHML.js";var g=B($());function j(a,s){a&1&&(r(0,"span"),d(1,", "),o())}function L(a,s){if(a&1&&(r(0,"span"),d(1),_(2,j,2,0,"span",13),o()),a&2){let i=s.$implicit,e=s.index,t=c().$implicit,n=c();l(),M(" ",n.getEspecialidadNombre(i),""),l(),p("ngIf",e<t.especialidadesIds.length-1)}}function z(a,s){if(a&1){let i=w();r(0,"tr",18)(1,"td",19),d(2),o(),r(3,"td",19),d(4),o(),r(5,"td",19),d(6),o(),r(7,"td",19)(8,"input",20),u("change",function(){let t=m(i).$implicit,n=c(3);return h(n.toggleDeleteSelection(t.id))}),o(),r(9,"button",21),u("click",function(){let t=m(i).$implicit,n=c(3);return h(n.editHorario(t))}),d(10,"Editar"),o()()()}if(a&2){let i=s.$implicit;l(2),x(i.dia),l(2),x(i.horaInicio),l(2),x(i.horaFin)}}function q(a,s){if(a&1&&(r(0,"table",14)(1,"thead")(2,"tr",15)(3,"th",16),d(4,"D\xEDa"),o(),r(5,"th",16),d(6,"Hora Inicio"),o(),r(7,"th",16),d(8,"Hora Fin"),o(),r(9,"th",16),d(10,"Acciones"),o()()(),r(11,"tbody"),_(12,z,11,3,"tr",17),o()()),a&2){let i=c().$implicit,e=c();l(12),p("ngForOf",e.horariosPorMedico[i.id])}}function G(a,s){a&1&&(r(0,"p",22),d(1," No hay horarios para este m\xE9dico. "),o())}function R(a,s){if(a&1){let i=w();r(0,"button",23),u("click",function(){m(i);let t=c(2);return h(t.deleteSelectedHorarios())}),d(1," Eliminar Seleccionados "),o()}}function J(a,s){if(a&1&&(r(0,"div",6)(1,"h2",7),d(2),o(),r(3,"p",8),d(4," Especialidad(es): "),_(5,L,3,2,"span",9),o(),_(6,q,13,1,"table",10)(7,G,2,0,"p",11)(8,R,2,0,"button",12),o()),a&2){let i=s.$implicit,e=c();l(2),y(" ",i.nombre," ",i.apellido," "),l(3),p("ngForOf",i.especialidadesIds),l(),p("ngIf",e.horariosPorMedico[i.id]&&e.horariosPorMedico[i.id].length>0),l(),p("ngIf",!e.horariosPorMedico[i.id]||e.horariosPorMedico[i.id].length===0),l(),p("ngIf",e.selectedForDeletion.size>0)}}function K(a,s){if(a&1&&(r(0,"option",35),d(1),o()),a&2){let i=s.$implicit;p("value",i.id),l(),y("",i.nombre," ",i.apellido,"")}}function Q(a,s){if(a&1){let i=w();r(0,"div",24)(1,"div",25)(2,"h2",26),d(3),o(),r(4,"label",27),d(5,"Seleccionar M\xE9dico"),o(),r(6,"select",28),E("ngModelChange",function(t){m(i);let n=c();return b(n.selectedMedicoId,t)||(n.selectedMedicoId=t),h(t)}),_(7,K,2,3,"option",29),o(),r(8,"label",27),d(9,"D\xEDa"),o(),r(10,"input",30),E("ngModelChange",function(t){m(i);let n=c();return b(n.selectedHorario.dia,t)||(n.selectedHorario.dia=t),h(t)}),o(),r(11,"label",27),d(12,"Hora Inicio"),o(),r(13,"input",31),E("ngModelChange",function(t){m(i);let n=c();return b(n.selectedHorario.horaInicio,t)||(n.selectedHorario.horaInicio=t),h(t)}),o(),r(14,"label",27),d(15,"Hora Fin"),o(),r(16,"input",31),E("ngModelChange",function(t){m(i);let n=c();return b(n.selectedHorario.horaFin,t)||(n.selectedHorario.horaFin=t),h(t)}),o(),r(17,"div",32)(18,"button",33),u("click",function(){m(i);let t=c();return h(t.saveHorario())}),d(19),o(),r(20,"button",34),u("click",function(){m(i);let t=c();return h(t.closeModal())}),d(21," Cancelar "),o()()()()}if(a&2){let i=c();l(3),x(i.isEditMode?"Editar Horario":"A\xF1adir Horario"),l(3),f("ngModel",i.selectedMedicoId),l(),p("ngForOf",i.medicos),l(3),f("ngModel",i.selectedHorario.dia),l(3),f("ngModel",i.selectedHorario.horaInicio),l(3),f("ngModel",i.selectedHorario.horaFin),l(3),M(" ",i.isEditMode?"Actualizar":"Guardar"," ")}}var oe=(()=>{let s=class s{constructor(e){this.http=e,this.medicos=[],this.especialidades=[],this.horariosPorMedico={},this.selectedHorario={id:0,dia:"",horaInicio:"",horaFin:"",medicoId:0},this.selectedMedicoId=null,this.isEditMode=!1,this.showModal=!1,this.selectedForDeletion=new Set}ngOnInit(){this.loadMedicos(),this.loadEspecialidades()}loadMedicos(){this.http.get("http://143.198.147.110/api/medicos").subscribe(e=>{this.medicos=e,this.loadHorariosForMedicos()},e=>{console.error("Error loading medicos",e)})}loadEspecialidades(){this.http.get("http://143.198.147.110/api/especialidades").subscribe(e=>{this.especialidades=e},e=>{console.error("Error loading especialidades",e)})}loadHorariosForMedicos(){this.medicos.forEach(e=>{this.http.get(`http://143.198.147.110/api/horarios/medico/${e.id}`).subscribe(t=>{this.horariosPorMedico[e.id]=t},t=>{console.error(`Error loading horarios for medico ${e.id}`,t)})})}getEspecialidadNombre(e){let t=this.especialidades.find(n=>n.id===e);return t?t.nombre:""}openAddHorarioModal(){this.selectedHorario={id:0,dia:"",horaInicio:"",horaFin:"",medicoId:this.selectedMedicoId||0},this.isEditMode=!1,this.showModal=!0}editHorario(e){this.selectedHorario=C({},e),this.isEditMode=!0,this.showModal=!0}deleteSelectedHorarios(){g.default.fire({title:"\xBFEliminar horarios seleccionados?",text:"Esta acci\xF3n no se puede deshacer",icon:"warning",showCancelButton:!0,confirmButtonText:"S\xED, eliminar"}).then(e=>{if(e.isConfirmed){let t=Array.from(this.selectedForDeletion).map(n=>this.http.delete(`http://143.198.147.110/api/horarios/${n}`).toPromise());Promise.all(t).then(()=>{g.default.fire("Eliminado","Los horarios seleccionados fueron eliminados correctamente.","success"),this.loadHorariosForMedicos(),this.selectedForDeletion.clear()}).catch(n=>{console.error("Error deleting horarios",n),g.default.fire("Error","Hubo un error al eliminar los horarios.","error")})}})}toggleDeleteSelection(e){this.selectedForDeletion.has(e)?this.selectedForDeletion.delete(e):this.selectedForDeletion.add(e)}saveHorario(){if(!this.selectedMedicoId){g.default.fire("Error","Debe seleccionar un m\xE9dico.","error");return}this.selectedHorario.medicoId=this.selectedMedicoId;let e=this.isEditMode?`http://143.198.147.110/api/horarios/${this.selectedHorario.id}`:`http://143.198.147.110/api/horarios/medico/${this.selectedMedicoId}`;(this.isEditMode?this.http.put(e,this.selectedHorario):this.http.post(e,this.selectedHorario)).subscribe(()=>{this.loadHorariosForMedicos(),this.showModal=!1,g.default.fire(this.isEditMode?"Actualizado":"Creado",`El horario ha sido ${this.isEditMode?"actualizado":"creado"} correctamente.`,"success")},n=>{console.error("Error saving horario",n),g.default.fire("Error","Hubo un error al guardar el horario.","error")})}closeModal(){this.showModal=!1}};s.\u0275fac=function(t){return new(t||s)(v(k))},s.\u0275cmp=H({type:s,selectors:[["app-horarios"]],standalone:!0,features:[S],decls:8,vars:2,consts:[[1,"container","mx-auto","px-4","py-8"],[1,"text-3xl","font-bold","mb-8","text-center","text-gray-800"],[1,"flex","justify-center","mb-6"],[1,"bg-green-500","text-white","px-4","py-2","rounded",3,"click"],["class","mb-8 p-6 bg-white shadow-lg rounded-lg border border-gray-200",4,"ngFor","ngForOf"],["style","position: fixed; top: 0; left: 0; right: 0; bottom: 0; background-color: rgba(0, 0, 0, 0.5); display: flex; align-items: center; justify-content: center;",4,"ngIf"],[1,"mb-8","p-6","bg-white","shadow-lg","rounded-lg","border","border-gray-200"],[1,"text-2xl","font-semibold","text-gray-700","mb-2"],[1,"text-gray-600","italic","mb-4"],[4,"ngFor","ngForOf"],["class","min-w-full bg-white border rounded-lg",4,"ngIf"],["class","text-gray-600 mt-4",4,"ngIf"],["class","bg-red-500 text-white px-4 py-2 rounded mt-4 hover:bg-red-600",3,"click",4,"ngIf"],[4,"ngIf"],[1,"min-w-full","bg-white","border","rounded-lg"],[1,"bg-gray-800","text-white"],[1,"p-4","text-left"],["class","hover:bg-gray-100",4,"ngFor","ngForOf"],[1,"hover:bg-gray-100"],[1,"p-4"],["type","checkbox",1,"mr-2",3,"change"],[1,"bg-blue-500","text-white","px-3","py-1","rounded","mr-2","hover:bg-blue-600",3,"click"],[1,"text-gray-600","mt-4"],[1,"bg-red-500","text-white","px-4","py-2","rounded","mt-4","hover:bg-red-600",3,"click"],[2,"position","fixed","top","0","left","0","right","0","bottom","0","background-color","rgba(0, 0, 0, 0.5)","display","flex","align-items","center","justify-content","center"],[2,"background-color","white","padding","24px","border-radius","8px","width","500px","max-width","90%","box-shadow","0px 4px 10px rgba(0, 0, 0, 0.1)"],[1,"text-2xl","font-bold","mb-4","text-center"],[1,"block","font-bold","text-gray-700","mb-1"],[1,"w-full","px-3","py-2","mb-4","border","rounded-lg",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["placeholder","D\xEDa de la semana",1,"w-full","px-3","py-2","mb-4","border","rounded-lg",3,"ngModelChange","ngModel"],["type","time",1,"w-full","px-3","py-2","mb-4","border","rounded-lg",3,"ngModelChange","ngModel"],[1,"flex","justify-between","mt-4"],[1,"bg-blue-500","text-white","px-4","py-2","rounded","hover:bg-blue-600",3,"click"],[1,"bg-gray-500","text-white","px-4","py-2","rounded","hover:bg-gray-600",3,"click"],[3,"value"]],template:function(t,n){t&1&&(r(0,"div",0)(1,"h1",1),d(2,"Gestionar Horarios de M\xE9dicos"),o(),r(3,"div",2)(4,"button",3),u("click",function(){return n.openAddHorarioModal()}),d(5," A\xF1adir Horario "),o()(),_(6,J,9,6,"div",4)(7,Q,22,7,"div",5),o()),t&2&&(l(6),p("ngForOf",n.medicos),l(),p("ngIf",n.showModal))},dependencies:[V,I,F,N,W,A,T,O,D,P]});let a=s;return a})();export{oe as HorariosComponent};
