import{a as w}from"./chunk-MSGFT5JS.js";import{b as S}from"./chunk-6QFG5ZSD.js";import{Ba as r,Ca as v,Oa as x,Qa as u,Qb as A,Ta as t,Tb as I,Ua as i,Za as g,aa as h,d as y,db as a,eb as p,gb as b,mb as E,ya as f}from"./chunk-TYC4EHML.js";var s=y(w());function P(l,o){if(l&1&&(t(0,"tr")(1,"td",7),a(2),i(),t(3,"td",7),a(4),i(),t(5,"td",7),a(6),i(),t(7,"td",7),a(8),i(),t(9,"td",7)(10,"a",8),a(11,"Ver archivo"),i()()()),l&2){let c=o.$implicit;r(2),p(c.fechaRealizacion),r(2),p(c.tipoAnalisis),r(2),p(c.resultado),r(2),b("",c.medicoNombre," ",c.medicoApellido,""),r(2),u("href",c.archivoUrl,f)}}var _=(()=>{let o=class o{constructor(e){this.http=e,this.analisisList=[],this.pacientes=[],this.tiposAnalisis=["Hemograma completo","Prueba de glucosa","Perfil lip\xEDdico","Prueba de funci\xF3n hep\xE1tica","Prueba de tiroides","Prueba de embarazo","Uroan\xE1lisis","Prueba de VIH","Cultivo de sangre","Panel metab\xF3lico completo"],this.usuarioId=parseInt(localStorage.getItem("userId")||"0",10)-1}ngOnInit(){this.loadAnalisis(),this.loadPacientes()}loadAnalisis(){this.http.get(`http://143.198.147.110/api/analisis/medico/${this.usuarioId}`).subscribe(e=>{this.analisisList=e},e=>{s.default.fire({title:"Error al cargar an\xE1lisis",text:"Por favor, int\xE9ntalo nuevamente.",icon:"error",confirmButtonText:"Aceptar"}),console.error("Error al cargar an\xE1lisis",e)})}loadPacientes(){this.http.get("http://143.198.147.110/api/pacientes").subscribe(e=>{this.pacientes=e},e=>{s.default.fire({title:"Error al cargar pacientes",text:"Por favor, int\xE9ntalo nuevamente.",icon:"error",confirmButtonText:"Aceptar"}),console.error("Error al cargar pacientes",e)})}crearAnalisis(){s.default.fire({title:"Crear An\xE1lisis",html:`
         <p>Selecciona Un Paciente</p>
        <select id="pacienteId" class="swal2-input">
          ${this.pacientes.map(e=>`<option value="${e.id}">${e.usuario.nombre} ${e.usuario.apellido}</option>`).join("")}
        </select>
        <p>Selecciona un tipo de Analisis</p>
        <select id="tipoAnalisis" class="swal2-input">
          ${this.tiposAnalisis.map(e=>`<option value="${e}">${e}</option>`).join("")}
        </select>
        <textarea id="resultado" class="swal2-textarea" placeholder="Resultado"></textarea>
        <input id="archivoUrl" class="swal2-input" placeholder="URL del Archivo">
      `,focusConfirm:!1,preConfirm:()=>{let e=document.getElementById("pacienteId").value,n=document.getElementById("tipoAnalisis").value,d=document.getElementById("resultado").value,m=document.getElementById("archivoUrl").value;return(!e||!n||!m)&&s.default.showValidationMessage("Todos los campos son obligatorios"),{pacienteId:parseInt(e),tipoAnalisis:n,resultado:d,archivoUrl:m}}}).then(e=>{if(e.isConfirmed){let n={pacienteId:e.value?.pacienteId,medicoId:this.usuarioId,tipoAnalisis:e.value?.tipoAnalisis,resultado:e.value?.resultado,fechaRealizacion:new Date().toISOString().split("T")[0],archivoUrl:e.value?.archivoUrl};this.http.post("http://143.198.147.110/api/analisis",n).subscribe(()=>{s.default.fire("An\xE1lisis creado","El an\xE1lisis se ha creado exitosamente","success"),this.loadAnalisis()},d=>{s.default.fire({title:"Error al crear an\xE1lisis",text:"Por favor, int\xE9ntalo nuevamente.",icon:"error",confirmButtonText:"Aceptar"}),console.error("Error al crear an\xE1lisis",d)})}})}};o.\u0275fac=function(n){return new(n||o)(v(S))},o.\u0275cmp=h({type:o,selectors:[["app-analisis-list"]],standalone:!0,features:[E],decls:20,vars:1,consts:[[1,"container","mx-auto","px-4","py-8"],[1,"text-2xl","font-bold","mb-4","text-center"],[1,"bg-green-500","text-white","px-4","py-2","rounded-lg","mb-4",3,"click"],[1,"min-w-full","bg-white","shadow-lg","rounded-lg"],[2,"background-color","#343a40","color","white"],[1,"px-4","py-2"],[4,"ngFor","ngForOf"],[1,"border","px-4","py-2"],["target","_blank",1,"text-blue-500","underline",3,"href"]],template:function(n,d){n&1&&(t(0,"div",0)(1,"h1",1),a(2,"Mis An\xE1lisis"),i(),t(3,"button",2),g("click",function(){return d.crearAnalisis()}),a(4," Crear An\xE1lisis "),i(),t(5,"table",3)(6,"thead")(7,"tr",4)(8,"th",5),a(9,"Fecha"),i(),t(10,"th",5),a(11,"Tipo de An\xE1lisis"),i(),t(12,"th",5),a(13,"Resultado"),i(),t(14,"th",5),a(15,"M\xE9dico"),i(),t(16,"th",5),a(17,"URL Archivo"),i()()(),t(18,"tbody"),x(19,P,12,6,"tr",6),i()()()),n&2&&(r(19),u("ngForOf",d.analisisList))},dependencies:[I,A]});let l=o;return l})();export{_ as AnalisisListComponent};
