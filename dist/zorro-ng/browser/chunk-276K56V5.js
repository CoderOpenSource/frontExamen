import{a as L}from"./chunk-4IA42FLE.js";import{a as N,b as W,e as P,h as A,i as j,k as B,m as D}from"./chunk-OGDTTBTQ.js";import{b as F}from"./chunk-6QFG5ZSD.js";import{Ba as d,Ca as C,Oa as g,Pb as T,Qa as c,Qb as I,Rb as k,Ta as i,Tb as V,Ua as a,Ya as b,Za as p,_a as u,aa as x,db as n,eb as h,fb as w,ib as E,ja as M,jb as y,ka as _,kb as v,mb as S,sa as O}from"./chunk-TYC4EHML.js";function J(s,l){if(s&1&&(i(0,"option",17),n(1),a()),s&2){let r=l.$implicit;c("ngValue",r.id),d(),h(r.nombre)}}function K(s,l){if(s&1&&(i(0,"div",18),n(1),a()),s&2){let r=u();c("ngClass",r.toastClass),d(),w(" ",r.toastMessage,`
`)}}var z=(()=>{let l=class l{constructor(e){this.http=e,this.materia={id:0,nombre:"",creditos:0,carrera:{id:null,nombre:""}},this.isEditMode=!1,this.closeModal=new O,this.saveMateria=new O,this.carreras=[],this.toastMessage=null,this.toastClass=""}ngOnInit(){this.loadCarreras(),this.isEditMode||(this.materia={id:0,nombre:"",creditos:0,carrera:{id:null,nombre:""}})}loadCarreras(){this.http.get("http://68.183.146.53/carreras/").subscribe(e=>{this.carreras=e},e=>{console.error("Error loading carreras",e)})}showToast(e,t){this.toastMessage=e,this.toastClass=t==="success"?"bg-green-500 text-white":"bg-red-500 text-white",setTimeout(()=>{this.toastMessage=null},2e3)}onClose(){this.closeModal.emit()}onSave(){this.saveMateria.emit(this.materia)}};l.\u0275fac=function(t){return new(t||l)(C(F))},l.\u0275cmp=x({type:l,selectors:[["app-materia-modal"]],inputs:{materia:"materia",isEditMode:"isEditMode"},outputs:{closeModal:"closeModal",saveMateria:"saveMateria"},standalone:!0,features:[S],decls:26,vars:7,consts:[[1,"fixed","inset-0","bg-gray-600","bg-opacity-50","overflow-y-auto","h-full","w-full",3,"click"],[1,"relative","top-20","mx-auto","p-5","border","w-96","shadow-lg","rounded-md","bg-white",3,"click"],[1,"mt-3","text-center","text-blue-700","font-bold"],[1,"mt-4"],[1,"mb-4"],["for","nombre",1,"block","text-gray-700","text-sm","font-bold","mb-2"],["placeholder","Ingrese el nombre",1,"shadow","appearance-none","border","rounded","w-full","py-2","px-3","text-gray-700","leading-tight","focus:outline-none","focus:shadow-outline",3,"ngModelChange","ngModel"],["for","creditos",1,"block","text-gray-700","text-sm","font-bold","mb-2"],["placeholder","Ingrese los cr\xE9ditos",1,"shadow","appearance-none","border","rounded","w-full","py-2","px-3","text-gray-700","leading-tight","focus:outline-none","focus:shadow-outline",3,"ngModelChange","ngModel"],["for","carrera",1,"block","text-gray-700","text-sm","font-bold","mb-2"],[1,"shadow","appearance-none","border","rounded","w-full","py-2","px-3","text-gray-700","leading-tight","focus:outline-none","focus:shadow-outline",3,"ngModelChange","ngModel"],["disabled","",3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"flex","items-center","justify-between","px-4","py-3","space-x-4"],[1,"px-4","py-2","bg-blue-500","text-white","text-base","font-medium","rounded-md","shadow-sm","w-1/2",3,"click"],[1,"px-4","py-2","bg-gray-500","text-white","text-base","font-medium","rounded-md","shadow-sm","w-1/2",3,"click"],["class","fixed bottom-4 left-4 px-4 py-2 rounded shadow-lg",3,"ngClass",4,"ngIf"],[3,"ngValue"],[1,"fixed","bottom-4","left-4","px-4","py-2","rounded","shadow-lg",3,"ngClass"]],template:function(t,o){t&1&&(i(0,"div",0),p("click",function(){return o.onClose()}),i(1,"div",1),p("click",function(m){return m.stopPropagation()}),i(2,"h3",2),n(3),a(),i(4,"div",3)(5,"div",4)(6,"label",5),n(7,"Nombre"),a(),i(8,"input",6),v("ngModelChange",function(m){return y(o.materia.nombre,m)||(o.materia.nombre=m),m}),a()(),i(9,"div",4)(10,"label",7),n(11,"Cr\xE9ditos"),a(),i(12,"input",8),v("ngModelChange",function(m){return y(o.materia.creditos,m)||(o.materia.creditos=m),m}),a()(),i(13,"div",4)(14,"label",9),n(15,"Carrera"),a(),i(16,"select",10),v("ngModelChange",function(m){return y(o.materia.carrera.id,m)||(o.materia.carrera.id=m),m}),i(17,"option",11),n(18,"Seleccione una carrera"),a(),g(19,J,2,2,"option",12),a()()(),i(20,"div",13)(21,"button",14),p("click",function(){return o.onSave()}),n(22,"Guardar"),a(),i(23,"button",15),p("click",function(){return o.onClose()}),n(24,"Cerrar"),a()()()(),g(25,K,2,2,"div",16)),t&2&&(d(3),h(o.isEditMode?"Editar Materia":"A\xF1adir Materia"),d(5),E("ngModel",o.materia.nombre),d(4),E("ngModel",o.materia.creditos),d(4),E("ngModel",o.materia.carrera.id),d(),c("ngValue",null),d(2),c("ngForOf",o.carreras),d(6),c("ngIf",o.toastMessage))},dependencies:[V,T,I,k,D,j,B,N,A,W,P]});let s=l;return s})();function Q(s,l){if(s&1){let r=b();i(0,"tr")(1,"td",3),n(2),a(),i(3,"td",3),n(4),a(),i(5,"td",3),n(6),a(),i(7,"td",3),n(8),a(),i(9,"td",3)(10,"button",10),p("click",function(){let t=M(r).$implicit,o=u();return _(o.editMateria(t.id))}),n(11,"Editar"),a(),i(12,"button",11),p("click",function(){let t=M(r).$implicit,o=u();return _(o.confirmDelete(t.id))}),n(13,"Eliminar"),a()()()}if(s&2){let r=l.$implicit;d(2),h(r.id),d(2),h(r.nombre),d(2),h(r.creditos),d(2),h(r.carrera.nombre)}}function R(s,l){if(s&1){let r=b();i(0,"app-materia-modal",12),p("closeModal",function(){M(r);let t=u();return _(t.handleCloseModal())})("saveMateria",function(t){M(r);let o=u();return _(o.saveMateria(t))}),a()}if(s&2){let r=u();c("materia",r.selectedMateria)("isEditMode",r.isEditMode)}}function U(s,l){if(s&1){let r=b();i(0,"app-confirm-modal",13),p("confirm",function(){M(r);let t=u();return _(t.deleteMateria())})("cancel",function(){M(r);let t=u();return _(t.handleCloseConfirmModal())}),a()}}function X(s,l){if(s&1&&(i(0,"div",14),n(1),a()),s&2){let r=u();c("ngClass",r.toastClass),d(),w(" ",r.toastMessage,`
`)}}var de=(()=>{let l=class l{constructor(e){this.http=e,this.materias=[],this.selectedMateria={id:0,nombre:"",creditos:0,carrera:{id:0,nombre:""}},this.showModal=!1,this.showConfirmModal=!1,this.isEditMode=!1,this.materiaIdToDelete=null,this.toastMessage=null,this.toastClass=""}ngOnInit(){this.loadMaterias()}loadMaterias(){this.http.get("http://68.183.146.53/materias/").subscribe(e=>{this.materias=e},e=>{console.error("Error loading materias",e)})}editMateria(e){this.selectedMateria=this.materias.find(t=>t.id===e)||this.selectedMateria,this.isEditMode=!0,this.showModal=!0}addMateria(){this.selectedMateria={id:0,nombre:"",creditos:0,carrera:{id:0,nombre:""}},this.isEditMode=!1,this.showModal=!0}confirmDelete(e){this.materiaIdToDelete=e,this.showConfirmModal=!0}deleteMateria(){this.materiaIdToDelete!==null&&this.http.delete(`http://68.183.146.53/materias/${this.materiaIdToDelete}`).subscribe(()=>{this.showToast("Materia eliminada con \xE9xito","success"),this.loadMaterias(),this.materiaIdToDelete=null,this.showConfirmModal=!1},e=>{this.showToast("Error al eliminar la materia","error"),console.error("Error deleting materia",e)})}cancelDelete(){this.materiaIdToDelete=null,this.showConfirmModal=!1}saveMateria(e){this.isEditMode?this.http.put(`http://68.183.146.53/materias/${e.id}`,e).subscribe(t=>{this.showToast("Materia actualizada con \xE9xito","success"),this.loadMaterias()},t=>{this.showToast("Error al actualizar la materia","error"),console.error("Error updating materia",t)}):this.http.post("http://68.183.146.53/materias/",e).subscribe(t=>{this.showToast("Materia creada con \xE9xito","success"),this.loadMaterias()},t=>{this.showToast("Error al crear la materia","error"),console.error("Error creating materia",t)}),this.handleCloseModal()}handleCloseModal(){this.showModal=!1}handleCloseConfirmModal(){this.showConfirmModal=!1}showToast(e,t){this.toastMessage=e,this.toastClass=t==="success"?"bg-green-500 text-white":"bg-red-500 text-white",setTimeout(()=>{this.toastMessage=null},2e3)}};l.\u0275fac=function(t){return new(t||l)(C(F))},l.\u0275cmp=x({type:l,selectors:[["app-materias"]],standalone:!0,features:[S],decls:24,vars:4,consts:[[1,"container","mx-auto","px-4","py-8"],[1,"text-2xl","font-bold","mb-4","text-center"],[1,"min-w-full","bg-white","text-center"],[1,"py-2","px-4","border-b"],[4,"ngFor","ngForOf"],[1,"flex","justify-start","mt-4"],[1,"bg-green-500","text-white","px-4","py-2","rounded-md",3,"click"],[3,"materia","isEditMode","closeModal","saveMateria",4,"ngIf"],[3,"confirm","cancel",4,"ngIf"],["class","toast",3,"ngClass",4,"ngIf"],[1,"bg-blue-500","text-white","px-3","py-1","rounded-md",3,"click"],[1,"bg-red-500","text-white","px-3","py-1","rounded-md","ml-2",3,"click"],[3,"closeModal","saveMateria","materia","isEditMode"],[3,"confirm","cancel"],[1,"toast",3,"ngClass"]],template:function(t,o){t&1&&(i(0,"div",0)(1,"h1",1),n(2,"Gestionar Materias"),a(),i(3,"table",2)(4,"thead")(5,"tr")(6,"th",3),n(7,"ID"),a(),i(8,"th",3),n(9,"Nombre"),a(),i(10,"th",3),n(11,"Cr\xE9ditos"),a(),i(12,"th",3),n(13,"Carrera"),a(),i(14,"th",3),n(15,"Acciones"),a()()(),i(16,"tbody"),g(17,Q,14,4,"tr",4),a()(),i(18,"div",5)(19,"button",6),p("click",function(){return o.addMateria()}),n(20,"A\xF1adir Materia"),a()()(),g(21,R,1,2,"app-materia-modal",7)(22,U,1,0,"app-confirm-modal",8)(23,X,2,2,"div",9)),t&2&&(d(17),c("ngForOf",o.materias),d(4),c("ngIf",o.showModal),d(),c("ngIf",o.showConfirmModal),d(),c("ngIf",o.toastMessage))},dependencies:[V,T,I,k,D,z,L],styles:["table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:10px;text-align:left;border:1px solid #dee2e6}th[_ngcontent-%COMP%]{background-color:#011d3a;color:#fff}"]});let s=l;return s})();export{de as MateriasComponent};
